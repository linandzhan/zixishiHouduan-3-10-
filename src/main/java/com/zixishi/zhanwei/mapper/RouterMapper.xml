<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zixishi.zhanwei.mapper.RouterMapper">
    <resultMap id="routerMap" type="router">
        <id property="id" column="id"/>
        <result property="displayName" column="display_name"/>
        <result property="icon" column="icon"/>
        <result property="mid" column="mid"/>
        <collection property="children" ofType="router" select="getRouterChildren" column="id"></collection>
    </resultMap>




    <select id="getRouterChildren" resultType="router">
        select * from router where parent_id = #{id}
    </select>

    <select id="search" resultMap="routerMap" parameterType="role">
        select * from router where id in (select router_id from router_role where role_id = #{id}) and parent_id is null order by id asc
    </select>


</mapper>